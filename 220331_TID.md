# 3월 31일 (목)

## 오늘 한 일

* 문제해결 빅데이터 활용 프로젝트

  * 00:06

    * svg 가운데정렬 후 크기 늘리기 완료

      ![image](https://user-images.githubusercontent.com/75322297/160868020-6aeebf1a-01d3-4321-9840-83ecfdab92f0.png)

  * 00:07

    * 추가로 키워드/카테고리 워드클라우드 부분을 키워드별로 나누지 않고 사고유형 별로 하나만 나오게 만들었다.

      ![image](https://user-images.githubusercontent.com/75322297/160868709-b1b41495-8625-4462-b8f4-07d312c69278.png)

      ![image](https://user-images.githubusercontent.com/75322297/160874947-5df41ce0-3b81-4106-bdf2-aff793fe4c96.png)

  * 00:18

    * 포트포워딩 재시도해야징!

  * 00:29

    * 잘 나오긴 하는데 역시 반응형이 아니라 꼴보기 싫다.

      ![image](https://user-images.githubusercontent.com/75322297/160875259-9399a1b6-d528-4693-a7fb-99d332b0ed78.png)

  * 01:16

    * 안보이고 애매한 것들 반응형으로 제작 중
    
  * 02:26
  
    * 반응형으로 제작했다. 이제 chart.js를 div크기에 맞추는 것도 **쉽다.**
  
      ![image](https://user-images.githubusercontent.com/75322297/160895117-1d5bc835-9399-4568-afa1-315070fa1326.png)
  
    * html을 구성할 때 사용할 div를 잘 짜주고
  
    * chart.js의 옵션부분에 이걸 꼭 적어서 false로 만들어주자.
  
      ```js
      options: {
                      // responsive: false,
                      maintainAspectRatio: false,
      ```
  
    * 그리고 `<canvas>` 부분에서 `vw(너비)`, `vh(높이)` 반응형 너비와 높이로 적어주면 완성이다.
  
    * 대신에 vw, vh를 사용할 때는 100, 100이 아닌 div가 전체 html영역 내에서 사용되는 %를 생각하고 사용해야한다.
  
  * 02:38
  
    * 확인 결과, 아이패드에서도 잘나온다!
  
  * 04:12
  
    * 핸드폰에서도 잘 나오게 설정했당.
    
    * `<head>`부분의 `<meta>`에서 `initial-scale = 0.5`, `maximum-scale=1`로 설정
    
      ![image](https://user-images.githubusercontent.com/75322297/160914921-694beb93-8219-49a2-ac29-c3bf2a226382.png)
    
  * 09:27
  
    * AWS에 장고를 올리기 위해 팀원분들께서 세팅하는 중입니다.
  
      ![image](https://user-images.githubusercontent.com/75322297/160952488-bade79b7-3846-4bef-8cfb-0cb7c888c324.png)
  
  * 09:56
  
    * 관련 추천 블로그(네로의 다락방님) : [https://nerogarret.tistory.com/](https://nerogarret.tistory.com/)
  
  * 10:32
  
    * 크롤링이 끝났다.. 파일을 합쳐서 DB에 올려야겠다.
  
  * 11:20
  
    * frequentzoneOldman_keywordSearch.csv 통합 완료
  
  * 11:45
  
    * 마지막 import 중
  
      ![image](https://user-images.githubusercontent.com/75322297/160965889-5da25807-7271-4274-9410-397d1ea4eac5.png)
  
  * 14:20
  
    * guicon 껏다 키기
  
      * ```java
        sudo service mysite start
        sudo service mysite status
        ```
  
    * nginx 재시작
  
      * ```java
        sudo systemctl restart nginx
        sudo service mysite restart
        ```
  
  * 15:16
  
    * AWS에 장고올리기 완료!!
  
      * [http://35.77.242.184:8083/infra/keyword/](http://35.77.242.184:8083/infra/keyword/)
  
      ![image](https://user-images.githubusercontent.com/75322297/160988960-67cce9af-c9f8-4483-b7ca-0e8aae95d59b.png)
  
  * 15:22
  
    * import가 끝나질 않는다... 끝나면 외래키 지정해줘야한다.
    * FK 넣는 법 : [https://ls-jjong-coding.tistory.com/3](https://ls-jjong-coding.tistory.com/3)
  
  * 16:00
  
    * 성헌님이 발표하신다고하신다.❤ 
    * 리허설 준비 중이시다.
  
  * 16:40
  
    * 리허설 내용
  
      * ```
        (유쾌하게)
        
        안녕하세요 3조 DI 발표 시작하겠습니다.
        
        A .본격적으로 들어가기 전에 팀명 DI의 뜻을 맞추시는 분들께 저희 팀원들이 박수를 보내드리겠습니다.
        
        ( B .본격적으로 들어가기 전에 팀명 DI의 뜻이 뭘까요 ? 선착순 세명만 받겠습니다 )
        
        땡 
        
        땡
        
        땡
        
        정답은 동헌이의 아이들이었습니다 ! (갑분싸면 대실패 !  빠르게 넘어간다)
        
        이동헌강사님의 자랑스러운 제자들이라는 깊은 뜻을 담았습니다.
        
        
        
        1p. 표지 : 31초
        
        주제는 교통사고다발지역 주변 시설 분석을 통해 사고유형을 유추하고 인프라 재고의 필요성입니다.
        
        사이언스팀에서 인프라와 교통사고간의 상관관계를 분석하고 , 주변 시설 분석을 통해 사고유형을 유추하는 모델을 만들 것이라는 가정하에 
        
        엔지니어링팀에서는 인프라와 교통사고 관련 데이터 파이프라인을 구축했습니다.
        
        
        
        2p. 목차 : 42초
        
        발표는 기획의도부터 데이터를 어떻게 수집하고 처리했는지 이를 통해 어떤 인사이트를 도출해냈는지의 순서로 진행됩니다.
        
        
        
        3p. 개발동기 : 1분 10초
        
        Keyword : 교통사고유형 유추
        
        교통사고 예방을 위해 정부차원에서 여러가지 제도를 시행하고 있지만 여전히 교통사고는 매년 약 20만건씩 발생하고있습니다. 여기서 저희는 사고다발지역 주변 시설들을 분석해 어떤 시설들이 많이 있는 곳에서는 어떤 유형의 사고가 일어나니 그에 맞는 인프라를 추가 설치하면 교통사고 예방효과가 더 높아지지 않을까라는 생각부터 시작했습니다.
        
        > 갑자기 질문 생겼는데 
        >
        > 말할 때 
        >
        > 어린이 사고는 정말 어린이 관련 시설이 많은 곳에서 일어날까를 
        >
        > 확인해보고싶었다고 말하면 태클 들어올까여 ?
        
        
        
        4p~5p. 데이터수집 : 1분 50초 / 2분 1초
        
        파이프라인 구축하는 과정에서 먼저 사고와 인프라 관련 데이터를 수집하였습니다. 사고는 전국 단위로 노인,연휴,보행어린이,지자체별top3,스쿨존어린이,무단횡단 사고를 api로 받아 저장했습니다.
        
        인프라 데이터는 csv파일형태로 서울시 스마트횡단보도, 옐로카펫, 과속방지턱 , 무인교통단속카메라, 스마트가로등 ,어린이보호구역을 공공데이터포털에서 수집했습니다.
        
        추가적으로 시설 데이터가 필요해 주변검색키워드 선정을 위해 네이버 뉴스를 크롤링해 얻은 키워드들을 구글지도에 넣고 크롤링해 자료를 수집했습니다.
        
        
        
        6p. 데이터 저장 : 조금 끌어서 2분 46초
        
        공공기관과 네이버 뉴스 크롤링 바탕으로 각 사고 유형별 특성에 맞는 시설 키워드를 17개 추출하였습니다. 
        
        (목소리 좀 가다듬고 -> 사람들이 키워드 쓱 훑어볼 시간 주기)
        
        
        
        7p. 데이터 저장 : 3분 7초
        
        해당 키워드들은 이러한 과정으로 추출했는데 , 어린이와 노인 관련 시설은 공공기관 기준에 따라 키워드를 선정할 수 있었지만 사고유형 중 연휴와 무단횡단의 경우 특정 시설을 유추하기가 어려워 네이버 뉴스를 크롤링하여 워드 카운팅 후 시설 관련명만 추렸습니다.  
        
        
        
        --새로운거 : 3분 25초
        
        사고데이터를 수집하기 위해서 
        
        class 내에 사고데이터를 가져오는 json 함수, 
        
        SQL에 넣기 위해 json을 csv 파일로 바꾸는 csv 함수, 
        
        json 파일로 얻은 좌표를 구글지도에서 크롤링하는 크롤링함수를 만들었습니다. 
        
        
        
        다음장 넘어가서  : 3분 42초
        
        json 함수입니다
        
        구글 지도에서 사고다발지점 좌표를 넣어서 크롤링 하기위해서 api로 받은 데이터들을 json파일로 만들어놨으며
        
        
        
        다음장 넘어가서 : 3분 51초
        
        이것을 SQL형태로도 사용하고 싶어서 CSV로 변환해 따로 저장해놓았습니다.
        
        
        
        다음장 넘어가서 : 4분 1초
        
        그리고 만들어놓은 사고다발지점 json파일의 좌표와 저희가 선정한 키워드를 코드에 적용해 데이터를 수집했습니다.
        
        
        
        
        
        8p .데이터 저장 
        
        추출한 키워드들을 사고유형별 좌표 기준 주변검색에 넣어 나오는 시설명 , 카테고리 , 주소를 크롤링하여 시설관련 데이터를 수집하였습니다.
        
        
        
        9p. 데이터 저장 : 
        
        다음은 교통사고 데이터 크롤링한 데이터들을 몽고디비에 넣고 api필수키가 그 때그때 필요한 걸 요청하기 힘드니까 미리 파일로 만들어 뒀다. 
        
        > 이거 재원님이랑 같이 말 만들어봐여 ㅎㅎ
        
        
        
        10p. 데이터 저장
        
        api 자동화 코드를 만들어 데이터를 관리했는데 클래스 안에 함수들을 정의했습니다. 이로인해 각 api의 요청변수와 응답변수가 같아 한 번에 응답받아 관리 수정이 수월했습니다.
        
        
        
        11p. 데이터 파이프라인 : 4분26초
        
        앞서 이런 과정들로 로컬에서 파일데이터를 수집하고 크롤링하는 코드를 짜서 aws를 구축하고 aws 내 하둡에 데이터들을 저장했습니다. 해당 데이터들을 스파크에서 전처리 후 몽고디비와 마이에스큐엘 디비에 저장하여 최종적으로 장고에 배포까지 완료하는 파이프라인을 구축했습니다. 
        
        
        
        12p. 테이블 정의서 :  6분 1초
        
        다음은 전처리한 데이터들의 테이블 정의서입니다 . 인프라는 총 10개 , 사고데이터는 총 11개로 총 21개의 테이블을 만들었습니다. 각 데이터별 테이블 정의서를 하나씩만 살펴보고 넘어가겠습니다. : 4분 48초
        
        (인프라4 = 16p로 넘어가서) 이 테이블은 서울시 어린이 보호구역 설치현황 테이블로 컬럼값과 데이터 형식을 이런식으로 주고(?) pk로 id컬럼을 fk는 year_code 컬럼을 주었습니다.인프라 테이블은 대부분 이런 구조의 비슷한 형태로 구성하였습니다.  : 5분 7초
        
        (사고데이터1 =23p) 이 테이블은 전국 보행어린이 사고다발지역 현황 테이블로 id값을 pk로 주고 사고 관련 발생지역, 사상자수 , 위경도 등의 컬럼들로 구성했습니다. (다음장 사고 데이터1도 조금 보여주고 )  : 5분 27초
        
        (사고데이터7 =35p) 이 테이블은 보행자 어린이 사고다발지역 키워드를 크롤링한 데이터 테이블로 사고지역의 중심좌표와 키워드 시설 카테고리 시설명 등의 컬림으로 구성했습니다. ( 다음장도 살짝 보여주고 )  : 5분 52초
        
        
        
        45p. ERD  : 6분 30초
        
        위의 테이블들을 이런 구조로 만들었는데 인프라테이블들은 year테이블에 1:1 관계로 연결되어 해당 연도 사고 코드가 외래키로 year 테이블의 id 값에 연결해 연도별 코드를 부여했습니다. 
        
        우측에 사고테이블의 경우 연관성을 따로 만들 수 없어 관계가 없지만 아 몰랑 왜 근데 여기서 csv로 테이블 만들었다는 내용이 보이나요 ?
        
        > 말 이상하니까 같이 다듬어봐요 
        
        
        
        46p. 대시보드 : ( 말 조금 수정 ) 7분 5초
        
        프로세싱의 마지막 단계로 수집 가공한 데이터들을 대시보드에 표현했습니다.(?) 서울시 인프라와 교통사고 데이터를 한 번에 보여주며 쉽게 비교가 가능합니다.  인프라 데이터는 사고 유형별 해당연도의 설치개수를 시각화로 인프라 설치개수의 추이를 볼 수 있고 , 사고 데이터는 사고 유형별 사상자수를 시각화하여 연도가 지남에 따라 사상자수 변화를 한 눈에 파악할 수 있습니다.
        
        
        
        47p. 대시보드 : 7분 20초
        
        좌측 데이터는 인프라 누적데이터로 인프라별 설치현황을 파악할 수 있고 , 우측은 서울시 지역구당 인프라 개수를  볼 수 있습니다.
        
        
        
        48p. 대시보드 : 7분 40초
        
        인프라데이터의 중심좌표와 키워드를 넣은 구글지도 크롤링으로 사고유형별 시설 카테고리 빈도수를 시각화하여 각 사고유형별로 관련 시설이 어떤것이 있는지 파악할 수 있습니다.
        
        
        
        49p. 대시보드 : 7분 50초
        
        사고데이터로 각 사고 유형마다 어느 지역의 비중이 많고 적은지 비교할 수 있는 차트(그래프?)입니다.
        
        
        
        50p. 대시보드 : 8분 00초
        
        해당 데이터는 이전 데이터와 같지만 각 지역별로 사고유형의 비중을 파악할 수 있는 차트입니다.
        
        
        
        60p. 대시보드 :  8분 13초
        
        마지막으로 지자체별 사고건수가 많은 상위 3개의 지역에 관한 데이터 차트를 통해 전국 교통사고 중 어느 지역에서 사고가 많이 일어나는지 등의 비교를 할 수 있습니다.
        
        
        
        61p. 기대효과 : 8분 32초
        
        이런 과정을 통해 수집하고 가공한 데이터들로 사이언스팀에서 분석까지 완료한다면 교통사고 위험 지역에 적절한 인프라를 설치해 효율성은 높이고 이로 인해 교통사고 발생률은 낮출 수 있습니다.
        
        
        
        62p. 개발일정 : 8분 38초
        
        개발일정은 이러한 과정으로 이뤄졌고
        
        63p. 개발 환경 : 8분 43초
        
        개발환경과 사용한 툴들입니다.
        
        64p.  개발 후기 : 9분
        
        마지막으로 2주동안 함께 수고한 팀원들의 개발후기입니다.
        
        
        
        대시보드로 한 번 더 보여드리겠습니다
        
        
        
        
        
        65p. 큐앤에이
        
        이상으로 발표를 마치겠습니다. 질문 있으시다면 맘껏 던져주ㅅ세요/
        
        
        
        -----
        
        강사님 코멘트 .. .
        
        데이터 수집 > 출처랑 자료명 이동 
        
        데이터 유형 - 출처 - 자료유형 - 너무 비니까 비고 등으로 써서 표를 이쁘게 다시 만들기 
        
        
        
        크롤링 
        
        6 -> 7 넘어갈 때  꼬인거 ?
        
        
        
        8페이지 
        
        코드가 나오면 코드 자랑하고싶나 ? -> 깃헙 링크가면 있는 코드를 굳이 다시 쓴거면 얘네 너무 잘했다 아니면 
        
        조금만 꼬아서 보면 자랑할게 코드가 이것밖에 없나 
        
        이런코드를 잘했다고 자랑하는건가 라고 생각해서 
        
        개인적으로 포폴에 코드 넣는건 싫고
        
        정말 넣고싶으면 핵심적이고 자랑하고싶은 코드만 넣기 
        
        
        
        어떤걸 핵심적이라고 봐야해 ? ...
        
        코드를 넣고싶다면 안 에 들어가는 코드에 대해서 아주 정확히 알고 동작하는 것까지 알고있어야함 
        
        내부적으로 어떻게 동작하고있다는것ㄱ까지 알고있어야함 
        
        
        
        ** 데이터 자랑하고싶은거 너무 잘했다 ~
        
        데이터파이프라인 
        
        장고가 안에 들어가있어야함
        
        브라우저가 외부임 
        
        장고는 내부임 
        
        
        
        테이블 정의서는 뒤에 빼세요 
        
        
        
        테이블 정의서가 아니라 erd로 보여주는거임 
        
        
        
        논리 erd로 보여줘야함 
        
        한글로 보여줘야함 (CtoP같은거 )
        
        한페이지에 너무 많으니까 페이지 나누기 
        
        크기 키우고 피피티 봤을 때  얘는 뭐고 여기 뭐가 들어가는구나
        
        
        
        i표기법이면 pk로 안쓰고 
        
        괄호치고 fk정도로만 쓰던가 하면 됨
        
        
        
        WBS 
        
        지금 고치지 말고 나중에 융합플젝때 더 자세히 써야함
        
        왼쪽에 담당자가 들어감 
        
        내용들도 더 자세하게 들어가야함 
        
        공공데이터 수집 및 가공 -> 어떤데이터어떤데이터 어떤데이터
        
        주담당자가 누구냐 ( 다 같이 해도 주 !!)
        
        a고 a라고하면  
        
        하루정도는 겹칠수는 있지만 날짜가 겹치면 안됨 ..
        
        안겹치는게 좋아용 
        
        aws 구축도 열려있다고 가정하고 하는게 좋긴해요 
        
        우리가 특수한 상황임 
        
        
        
        파이프라인 에다가 크론탭 넣을수도 
        
        페이지 하나에 * 다섯개 넣어놓고 
        
        aws 안에 넣어놓고 
        
        
        
        api 홈페이지 쓰고 
        
        특정 파이썬 파일로 
        
        (사진 찍어놓은걸로 수정 )
        
        코드들을 한장까지 할애할 분량은 아니다 
        ```
  
    * 리허설 강사님 피드백
  
      * 데이터 수집 부분
        * 출처를 왼쪽으로 자료명을 오른쪽으로
        * 데이터 유형을 테이블로나누지말고 데이터유형 컬럼을 넣어서 확인시키기
      * 크롤링 부분
        * 발표 준비가 안되서 살짝 꼬인 부분
      * 테이블 정의서
        * PPT에서는 다 빼고 따로 첨부
      * ERD
        * 너무 많아서 페이지 2개로 나눠서 표현해라.
      * WBS
        * 담당자 부분을 추가하고 조금 더 자세히 적으면 좋겠다.
  
  * 17:36
  
    * 아직 DB에 Importing이 안끝났다.
    * 끝나고 FK지정해주고 장고에서 insepectdb해주고 models.py에 적용한 다음
    * 깃헙에 올리면 끝
  
  * 22:07
  
    * 아직도 임포팅중이다. 이게 맞나 싶다.
  
  * 23:24
  
    * 모여서 마지막 PPT 최종안 정리 중
